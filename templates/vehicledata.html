
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InsuranceIQ - AI-Powered Vehicle Insurance Predictor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Matrix Rain Effect -->
    <div class="matrix-rain" id="matrixRain"></div>
    
    <!-- Floating particles -->
    <div class="particles-container" id="particlesContainer"></div>
    
    <!-- Holographic Elements -->
    <div class="holographic-grid"></div>
    
    <!-- Cyber cursor -->
    <div class="cyber-cursor" id="cyberCursor">
        <div class="cursor-core"></div>
        <div class="cursor-ring"></div>
    </div>

    <!-- Background Audio Toggle -->
    <div class="audio-toggle" id="audioToggle">
        <i class="fas fa-volume-up" id="audioIcon"></i>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="logo-container">
                <div class="logo-hologram">
                    <i class="fas fa-brain"></i>
                </div>
                <h1 class="main-title">
                    <span class="title-main">Insurance</span>
                    <span class="title-accent">IQ</span>
                </h1>
                <div class="subtitle-container">
                    <p class="subtitle typing-text" id="subtitleText"></p>
                    <div class="pulse-indicator"></div>
                </div>
            </div>
        </div>

        <!-- Stats Counter -->
        <div class="stats-container">
            <div class="stat-item">
                <div class="stat-number" data-target="127849">0</div>
                <div class="stat-label">Predictions Made</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" data-target="98.7">0</div>
                <div class="stat-label">% Accuracy</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" data-target="1247">0</div>
                <div class="stat-label">Happy Clients</div>
            </div>
        </div>

        <!-- Fortune Cookie Messages -->
        <div class="fortune-container" id="fortuneContainer">
            <div class="fortune-message" id="fortuneMessage">
                <i class="fas fa-quote-left"></i>
                <span id="fortuneText">Your future insurance needs are written in data...</span>
                <i class="fas fa-quote-right"></i>
            </div>
        </div>

        <!-- Neural Network Visualization -->
        <div class="neural-network" id="neuralNetwork">
            <canvas id="networkCanvas"></canvas>
            <div class="network-status">
                <span class="status-dot"></span>
                <span>AI Neural Network Active</span>
            </div>
        </div>

        <!-- Form Container -->
        <div class="form-container-wrapper">
            <div class="form-header">
                <h2>
                    <i class="fas fa-robot"></i>
                    Let AI Predict Your Insurance Future
                </h2>
                <p class="form-description">
                    Our advanced machine learning algorithm analyzes millions of data points to predict your insurance likelihood with incredible precision. Experience the future of insurance today.
                </p>
            </div>

            <form method="post" action="/" id="predictionForm" class="cyber-form">
                <div class="form-grid">
                    <!-- Personal Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <span class="section-icon"><i class="fas fa-user-circle"></i></span>
                            Personal Profile
                        </h3>
                        
                        <div class="form-group">
                            <label for="Gender" class="cyber-label">
                                <i class="fas fa-venus-mars"></i>
                                <span>Gender Identity</span>
                                <div class="label-glow"></div>
                            </label>
                            <div class="select-wrapper">
                                <select id="Gender" name="Gender" required class="cyber-select">
                                    <option value="">Select Your Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                                <div class="select-arrow">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                            </div>
                            <div class="field-particles"></div>
                        </div>

                        <div class="form-group">
                            <label for="Age" class="cyber-label">
                                <i class="fas fa-birthday-cake"></i>
                                <span>Age Matrix</span>
                                <div class="label-glow"></div>
                            </label>
                            <input type="number" id="Age" name="Age" required 
                                   placeholder="Enter your age" min="18" max="100" class="cyber-input">
                            <div class="input-trail"></div>
                        </div>

                        <div class="form-group">
                            <label for="Driving_License" class="cyber-label">
                                <i class="fas fa-id-card"></i>
                                <span>License Authorization</span>
                                <div class="label-glow"></div>
                            </label>
                            <div class="toggle-wrapper">
                                <input type="hidden" id="Driving_License" name="Driving_License" value="0">
                                <div class="cyber-toggle" id="licenseToggle">
                                    <div class="toggle-slider"></div>
                                    <span class="toggle-text-off">No License</span>
                                    <span class="toggle-text-on">Licensed</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Location & History Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <span class="section-icon"><i class="fas fa-map-marker-alt"></i></span>
                            Location & History
                        </h3>

                        <div class="form-group">
                            <label for="Region_Code" class="cyber-label">
                                <i class="fas fa-globe-americas"></i>
                                <span>Region Code</span>
                                <div class="label-glow"></div>
                            </label>
                            <input type="number" step="0.01" id="Region_Code" name="Region_Code" required 
                                   placeholder="Geographic region identifier" class="cyber-input">
                            <div class="input-trail"></div>
                        </div>

                        <div class="form-group">
                            <label for="Previously_Insured" class="cyber-label">
                                <i class="fas fa-shield-alt"></i>
                                <span>Insurance History</span>
                                <div class="label-glow"></div>
                            </label>
                            <div class="toggle-wrapper">
                                <input type="hidden" id="Previously_Insured" name="Previously_Insured" value="0">
                                <div class="cyber-toggle" id="insuranceToggle">
                                    <div class="toggle-slider"></div>
                                    <span class="toggle-text-off">First Time</span>
                                    <span class="toggle-text-on">Previously Insured</span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="Vintage" class="cyber-label">
                                <i class="fas fa-clock"></i>
                                <span>Customer Vintage (Days)</span>
                                <div class="label-glow"></div>
                            </label>
                            <input type="number" id="Vintage" name="Vintage" required 
                                   placeholder="Days as customer" class="cyber-input">
                            <div class="input-trail"></div>
                        </div>
                    </div>

                    <!-- Financial & Policy Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <span class="section-icon"><i class="fas fa-dollar-sign"></i></span>
                            Financial Matrix
                        </h3>

                        <div class="form-group">
                            <label for="Annual_Premium" class="cyber-label">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>Annual Premium Value</span>
                                <div class="label-glow"></div>
                            </label>
                            <input type="number" step="0.01" id="Annual_Premium" name="Annual_Premium" required 
                                   placeholder="Premium amount" class="cyber-input">
                            <div class="input-trail"></div>
                            <div class="premium-indicator" id="premiumIndicator">
                                <span class="indicator-text">Premium Level: <span id="premiumLevel">Standard</span></span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="Policy_Sales_Channel" class="cyber-label">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Sales Channel ID</span>
                                <div class="label-glow"></div>
                            </label>
                            <input type="number" step="0.01" id="Policy_Sales_Channel" name="Policy_Sales_Channel" required 
                                   placeholder="Channel identifier" class="cyber-input">
                            <div class="input-trail"></div>
                        </div>
                    </div>

                    <!-- Vehicle Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <span class="section-icon"><i class="fas fa-car"></i></span>
                            Vehicle Profile
                        </h3>

                        <div class="form-group">
                            <label for="Vehicle_Age" class="cyber-label">
                                <i class="fas fa-car-side"></i>
                                <span>Vehicle Age Category</span>
                                <div class="label-glow"></div>
                            </label>
                            <div class="select-wrapper">
                                <select id="Vehicle_Age" name="Vehicle_Age" required class="cyber-select">
                                    <option value="">Select Vehicle Age</option>
                                    <option value="< 1 Year">🚗 Brand New (< 1 Year)</option>
                                    <option value="1-2 Year">🚙 Recent (1-2 Years)</option>
                                    <option value="> 2 Years">🚐 Mature (> 2 Years)</option>
                                </select>
                                <div class="select-arrow">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="Vehicle_Damage" class="cyber-label">
                                <i class="fas fa-tools"></i>
                                <span>Damage History</span>
                                <div class="label-glow"></div>
                            </label>
                            <div class="damage-selector">
                                <input type="hidden" id="Vehicle_Damage" name="Vehicle_Damage" value="">
                                <div class="damage-option" data-value="No">
                                    <div class="damage-icon">
                                        <i class="fas fa-shield-check"></i>
                                    </div>
                                    <span>Pristine</span>
                                </div>
                                <div class="damage-option" data-value="Yes">
                                    <div class="damage-icon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <span>Has Damage</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-section">
                    <div class="ai-status">
                        <div class="ai-indicator">
                            <div class="ai-pulse"></div>
                            <span>AI Ready</span>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button type="submit" class="cyber-btn cyber-btn-primary" id="predictBtn">
                            <div class="btn-bg"></div>
                            <div class="btn-content">
                                <i class="fas fa-brain"></i>
                                <span>Activate AI Prediction</span>
                            </div>
                            <div class="btn-particles"></div>
                        </button>
                        
                        <button type="button" class="cyber-btn cyber-btn-secondary" id="trainBtn">
                            <div class="btn-bg"></div>
                            <div class="btn-content">
                                <i class="fas fa-cogs"></i>
                                <span>Train Neural Network</span>
                            </div>
                            <div class="btn-particles"></div>
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Result Display -->
        {% if context and context != "Rendering" %}
        <div class="result-container" id="resultContainer">
            <div class="result-header">
                <h2>🔮 AI Oracle Speaks</h2>
            </div>
            <div class="result-content">
                <div class="result-visual">
                    {% if "Yes" in context %}
                        <div class="result-icon positive">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="result-message positive">
                            <h3>High Probability Detected!</h3>
                            <p>Our AI neural network predicts a strong likelihood of insurance interest. The data patterns align with positive engagement indicators.</p>
                        </div>
                    {% else %}
                        <div class="result-icon negative">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="result-message negative">
                            <h3>Low Probability Detected</h3>
                            <p>The AI analysis suggests minimal insurance likelihood based on current data patterns. Consider reviewing your profile parameters.</p>
                        </div>
                    {% endif %}
                </div>
                <div class="result-stats">
                    <div class="confidence-meter">
                        <span>Confidence Level</span>
                        <div class="meter">
                            <div class="meter-fill" style="width: {% if 'Yes' in context %}87%{% else %}23%{% endif %}"></div>
                        </div>
                        <span class="percentage">{% if 'Yes' in context %}87%{% else %}23%{% endif %}</span>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-content">
                <div class="neural-loader">
                    <div class="neural-node"></div>
                    <div class="neural-node"></div>
                    <div class="neural-node"></div>
                    <div class="neural-connections"></div>
                </div>
                <h3 id="loadingText">Initializing AI Neural Network...</h3>
                <div class="loading-progress">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <p class="loading-details" id="loadingDetails">Analyzing data patterns...</p>
            </div>
        </div>

        <!-- Notification System -->
        <div class="notification-container" id="notificationContainer"></div>
    </div>

    <!-- Background Audio (Subtle Ambient) -->
    <audio id="ambientAudio" loop>
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCSuBzvLZiTYIG2m98OScTgwO" type="audio/wav">
    </audio>

    <script>
        // Fortune messages array
        const fortuneMessages = [
            "Your data tells a story of infinite possibilities...",
            "The AI sees patterns humans cannot comprehend...",
            "In the matrix of probability, your path is illuminated...",
            "Machine learning whispers secrets of the future...",
            "Your digital footprint reveals hidden truths...",
            "The neural network dances with your destiny...",
            "Algorithms align to decode your insurance fate...",
            "In the realm of big data, all futures converge...",
            "The AI oracle awaits your command...",
            "Your profile resonates with the frequency of fortune..."
        ];

        // Typing effect for subtitle
        const subtitleTexts = [
            "AI-Powered Insurance Prediction",
            "Machine Learning at Your Service",
            "Decode Your Insurance Future",
            "Neural Networks Never Lie",
            "Data Science Meets Destiny"
        ];

        let currentSubtitleIndex = 0;
        let currentCharIndex = 0;
        let isDeleting = false;

        function typeWriter() {
            const subtitleElement = document.getElementById('subtitleText');
            const currentText = subtitleTexts[currentSubtitleIndex];

            if (!isDeleting) {
                subtitleElement.textContent = currentText.substring(0, currentCharIndex + 1);
                currentCharIndex++;

                if (currentCharIndex === currentText.length) {
                    isDeleting = true;
                    setTimeout(typeWriter, 2000);
                } else {
                    setTimeout(typeWriter, 100);
                }
            } else {
                subtitleElement.textContent = currentText.substring(0, currentCharIndex - 1);
                currentCharIndex--;

                if (currentCharIndex === 0) {
                    isDeleting = false;
                    currentSubtitleIndex = (currentSubtitleIndex + 1) % subtitleTexts.length;
                    setTimeout(typeWriter, 500);
                } else {
                    setTimeout(typeWriter, 50);
                }
            }
        }

        // Initialize typing effect
        typeWriter();

        // Stats counter animation
        function animateCounter(element, target, duration = 2000) {
            let start = 0;
            const increment = target / (duration / 16);
            
            function updateCounter() {
                start += increment;
                if (start < target) {
                    element.textContent = Math.floor(start);
                    requestAnimationFrame(updateCounter);
                } else {
                    element.textContent = target;
                }
            }
            
            updateCounter();
        }

        // Initialize counters when in view
        const observerOptions = {
            threshold: 0.5,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const statNumbers = entry.target.querySelectorAll('.stat-number');
                    statNumbers.forEach(stat => {
                        const target = parseFloat(stat.getAttribute('data-target'));
                        animateCounter(stat, target);
                    });
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        observer.observe(document.querySelector('.stats-container'));

        // Fortune message rotation
        let currentFortuneIndex = 0;
        function rotateFortune() {
            const fortuneText = document.getElementById('fortuneText');
            fortuneText.style.opacity = '0';
            
            setTimeout(() => {
                currentFortuneIndex = (currentFortuneIndex + 1) % fortuneMessages.length;
                fortuneText.textContent = fortuneMessages[currentFortuneIndex];
                fortuneText.style.opacity = '1';
            }, 500);
        }

        setInterval(rotateFortune, 4000);

        // Cyber cursor
        const cyberCursor = document.getElementById('cyberCursor');
        let mouseX = 0, mouseY = 0;
        let cursorX = 0, cursorY = 0;

        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        function animateCursor() {
            const dx = mouseX - cursorX;
            const dy = mouseY - cursorY;
            
            cursorX += dx * 0.1;
            cursorY += dy * 0.1;
            
            cyberCursor.style.transform = `translate(${cursorX}px, ${cursorY}px)`;
            requestAnimationFrame(animateCursor);
        }
        animateCursor();

        // Interactive toggles
        document.getElementById('licenseToggle').addEventListener('click', function() {
            this.classList.toggle('active');
            const hiddenInput = document.getElementById('Driving_License');
            hiddenInput.value = this.classList.contains('active') ? '1' : '0';
        });

        document.getElementById('insuranceToggle').addEventListener('click', function() {
            this.classList.toggle('active');
            const hiddenInput = document.getElementById('Previously_Insured');
            hiddenInput.value = this.classList.contains('active') ? '1' : '0';
        });

        // Damage selector
        document.querySelectorAll('.damage-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.damage-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                document.getElementById('Vehicle_Damage').value = this.getAttribute('data-value');
            });
        });

        // Premium indicator
        document.getElementById('Annual_Premium').addEventListener('input', function() {
            const value = parseFloat(this.value) || 0;
            const indicator = document.getElementById('premiumLevel');
            
            if (value < 10000) {
                indicator.textContent = 'Basic';
                indicator.style.color = '#4ade80';
            } else if (value < 30000) {
                indicator.textContent = 'Standard';
                indicator.style.color = '#fca311';
            } else {
                indicator.textContent = 'Premium';
                indicator.style.color = '#f72585';
            }
        });

        // Matrix rain effect
        function createMatrixRain() {
            const matrixRain = document.getElementById('matrixRain');
            const chars = '01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン';
            
            for (let i = 0; i < 50; i++) {
                const column = document.createElement('div');
                column.className = 'matrix-column';
                column.style.left = Math.random() * 100 + '%';
                column.style.animationDelay = Math.random() * 2 + 's';
                column.style.animationDuration = (Math.random() * 3 + 2) + 's';
                
                for (let j = 0; j < 20; j++) {
                    const char = document.createElement('span');
                    char.textContent = chars[Math.floor(Math.random() * chars.length)];
                    char.style.opacity = Math.random();
                    column.appendChild(char);
                }
                
                matrixRain.appendChild(column);
            }
        }

        createMatrixRain();

        // Particle system
        function createParticles() {
            const container = document.getElementById('particlesContainer');
            
            for (let i = 0; i < 100; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (Math.random() * 20 + 10) + 's';
                container.appendChild(particle);
            }
        }

        createParticles();

        // Form submission with loading animation
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            const loadingOverlay = document.getElementById('loadingOverlay');
            const predictBtn = document.getElementById('predictBtn');
            
            // Show loading overlay
            loadingOverlay.classList.add('active');
            
            // Simulate AI processing steps
            const steps = [
                'Initializing AI Neural Network...',
                'Preprocessing input data...',
                'Activating machine learning algorithms...',
                'Analyzing behavioral patterns...',
                'Computing probability matrices...',
                'Finalizing prediction model...',
                'Generating insights...'
            ];
            
            let currentStep = 0;
            const stepInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    document.getElementById('loadingText').textContent = steps[currentStep];
                    document.getElementById('loadingDetails').textContent = `Step ${currentStep + 1} of ${steps.length}`;
                    document.getElementById('progressBar').style.width = ((currentStep + 1) / steps.length * 100) + '%';
                    currentStep++;
                } else {
                    clearInterval(stepInterval);
                }
            }, 800);
        });

        // Train button functionality
        document.getElementById('trainBtn').addEventListener('click', async function() {
            this.disabled = true;
            this.innerHTML = '<div class="btn-bg"></div><div class="btn-content"><i class="fas fa-spinner fa-spin"></i><span>Training Neural Network...</span></div>';
            
            try {
                const response = await fetch('/train');
                if (response.ok) {
                    showNotification('Neural Network Training Complete! 🧠', 'success');
                } else {
                    showNotification('Training Failed. Please try again. ⚠️', 'error');
                }
            } catch (error) {
                showNotification('Network Error: ' + error.message, 'error');
            } finally {
                this.disabled = false;
                this.innerHTML = '<div class="btn-bg"></div><div class="btn-content"><i class="fas fa-cogs"></i><span>Train Neural Network</span></div>';
            }
        });

        // Notification system
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span>${message}</span>
                    <button class="notification-close">&times;</button>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                notification.classList.remove('show');
                setTimeout(() => {
                    container.removeChild(notification);
                }, 300);
            });
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            container.removeChild(notification);
                        }
                    }, 300);
                }
            }, 5000);
        }

        // Audio toggle
        const audioToggle = document.getElementById('audioToggle');
        const ambientAudio = document.getElementById('ambientAudio');
        let isAudioPlaying = false;

        audioToggle.addEventListener('click', function() {
            if (isAudioPlaying) {
                ambientAudio.pause();
                this.innerHTML = '<i class="fas fa-volume-mute"></i>';
                this.classList.add('muted');
            } else {
                ambientAudio.play();
                this.innerHTML = '<i class="fas fa-volume-up"></i>';
                this.classList.remove('muted');
            }
            isAudioPlaying = !isAudioPlaying;
        });

        // Easter eggs and interactions
        let clickCount = 0;
        document.querySelector('.logo-hologram').addEventListener('click', function() {
            clickCount++;
            if (clickCount >= 10) {
                showNotification('🎉 You\'ve discovered the AI Easter Egg! Welcome to the Matrix!', 'success');
                this.classList.add('easter-egg-active');
                clickCount = 0;
            }
        });

        // Dynamic background effects
        setInterval(() => {
            const holographicGrid = document.querySelector('.holographic-grid');
            holographicGrid.style.background = `
                linear-gradient(90deg, transparent 0%, rgba(76, 201, 240, 0.1) 50%, transparent 100%),
                linear-gradient(0deg, transparent 0%, rgba(67, 97, 238, 0.1) 50%, transparent 100%)
            `;
        }, 3000);

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Add entrance animations
            setTimeout(() => {
                document.body.classList.add('loaded');
            }, 500);
            
            // Show initial fortune message
            document.getElementById('fortuneText').textContent = fortuneMessages[0];
        });
    </script>
</body>
</html>
